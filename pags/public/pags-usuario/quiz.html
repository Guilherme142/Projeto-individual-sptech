<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel="stylesheet" href="../css/quiz.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <title>Quiz</title>
    </head>
    <body>
        <header>
            <div class="container-nav"> 
                <img src="../img/Dragon_Ball_logo.png" class="logo-navbar" alt="">
                <ul class="navbar">
                    <li><a href="campo-batalha.html">Torneio</a></li>
                    <li><a href="dashboard.html">Dashboard Quiz</a></li>
                    <li><a href="dashboard-batalha.html">Dashboard Torneio</a></li>
                    <li><a href="../index.html">Sair</a></li>
                </ul>
            </div>
        </header>
        <div id="section" class="section">
            <img src="../img/gokuzinho-nuvem.png" class="img-goku" alt="">
            <div class="bem-vindo"><h1 id="title_bemvindo"></h1></div>
            <div class="container-quiz">
                <div class="div-quiz">
                    <div class="nav-quiz" id="btns-navegar">
                        <button value="1" id="btnNav1" onclick="navegacao(this)" class="btn-nav-selecionado">1</button>
                        <button value="2" id="btnNav2" onclick="navegacao(this)" class="btn-nav">2</button>
                        <button value="3" id="btnNav3" onclick="navegacao(this)" class="btn-nav">3</button>
                        <button value="4" id="btnNav4" onclick="navegacao(this)" class="btn-nav">4</button>
                        <button value="5" id="btnNav5" onclick="navegacao(this)" class="btn-nav">5</button>
                        <button value="6" id="btnNav6" onclick="navegacao(this)" class="btn-nav">6</button>
                        <button value="7" id="btnNav7" onclick="navegacao(this)" class="btn-nav">7</button>
                    </div>
                    
                    <div class="pag1">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>1 - Qual é o primeiro personagem que encontra goku após a morte de seu avô?</p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta1Certa">Bulma</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta1Errado">Kuririn</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta1Errado">Vegeta</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta1Errado">Mestre Kame</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta1Errado">Yamcha</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button  onclick="navegacao(this)" value="2">Continuar</button></div>
                    </div>
                    <div class="pag2">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>2 - Qual dessas fusões utiliza brincos?</p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta2Errado">Gogeta</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta2Errado">Vekugo</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta2Certa">Vegeto</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta2Errado">Gotenks</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta2Errado">Goku black</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button onclick="navegacao(this)" value="1">Anterior</button><button onclick="navegacao(this)" value="3">Continuar</button></div>
                    </div>
                    <div class="pag3">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>3 - Quem foi o primeiro mestre que treinou goku?</p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta3Errado">Whis</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta3Errado">Kaioh</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta3Errado">Mestre karin</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta3Certa">Mestre Kame</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta3Errado">Brolly</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button onclick="navegacao(this)" value="2">Anterior</button><button onclick="navegacao(this)" value="4">Continuar</button></div>
                    </div>
                    <div class="pag4">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>4 - Quantas esféras são necessárias para invocar o shenlong?</p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta4Errado">14</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta4Certa">7</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta4Errado">8</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta4Errado">1</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta4Errado">5</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button onclick="navegacao(this)" value="3">Anterior</button><button onclick="navegacao(this)" value="5">Continuar</button></div>
                    </div>
                    <div class="pag5">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>5 - Qual desses não pertece a raça saiyajin?</p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta5Errado">Goku</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta5Errado">Vegeta</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta5Errado">Kakaroto</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta5Errado">Gohan</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta5Certa">Kuririn</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button onclick="navegacao(this)" value="4">Anterior</button><button onclick="navegacao(this)" value="6">Continuar</button></div>
                    </div>
                    <div class="pag6">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>6 - Qual o nome do avô do goku?</p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta6Certa">Son gohan</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta6Errado">Mestre Kame</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta6Errado">Bills</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta6Errado">Kaioh</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta6Errado">Piccolo</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button onclick="navegacao(this)" value="5">Anterior</button><button onclick="navegacao(this)" value="7">Continuar</button></div>
                    </div>
                    <div class="pag7">
                        <div class="div-pergunta ">
                            <div class="pergunta-quiz">
                                <p>7 - Quem é o Príncipe dos saiyajins? </p>
                            </div>
                        </div>
                        <div class="div-opcoes ">
                            <div class="opcoes-quiz">
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta7Errado">Chichi</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta7Errado">Goku</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta7Errado">Brolly</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta7Certa">Vegeta</button>
                                <button class="button-quiz" onclick="validacao(this)"value="pergunta7Errado">Black</button>
                            </div>
                        </div>
                        <div class="botoes-nav"><button onclick="navegacao(this)" value="6">Anterior</button><button onclick="finalizarQuiz()">Finalizar</button></div>
                    </div>
                    <div class="pag8">
                        <div class="div-resultado">
                            <div class="title-resultado">
                                <h1 class="h1-resultado">Resultado do seu quiz</h1>
                            </div>
                            <div class="conteudo-resultado">
                                <h1 class="resultado" id="resultado"></h1>
                                <div class="div-resultado-img">
                                    <img class="img-resultado" id="img_resultado" src="" alt="">
                                </div>
                            </div>
                        </div>
                        <div class="botoes-nav btnresultado">
                            <button class="btnresultadoClass"  onclick="window.location.reload()" >Refazer quiz</button>
                            <button class="btnresultadoClass"  onclick="window.location.href = 'campo-batalha.html';" >Ir pro desafio2</button></div>
                    </div>
                </div>              
                
            </div>
        </div>

    </body>
</html>
<script>
    title_bemvindo.innerHTML = "Bem Vindo "+ sessionStorage.NOME_USUARIO + ", responder o quiz é o seu desafio, Boa sorte."
    var pag1 = document.querySelector(".pag1");
    var pag2 = document.querySelector(".pag2");
    var pag3 = document.querySelector(".pag3");
    var pag4 = document.querySelector(".pag4");
    var pag5 = document.querySelector(".pag5");
    var pag6 = document.querySelector(".pag6");
    var pag7 = document.querySelector(".pag7");
    var pag8 = document.querySelector(".pag8");
    var btnNavs = document.getElementById('btns-navegar');
    var imgResultado = document.getElementById('img_resultado');
    var acertos = 0;
    var erros = 0;
    var respostas = [];
    var resposta1;
    var resposta2;
    var resposta3;
    var resposta4;
    var resposta5;
    var resposta6;
    var resposta7;
    var alternativa1="";
    var alternativa2="";
    var alternativa3="";
    var alternativa4="";
    var alternativa5="";
    var alternativa6="";
    var alternativa7="";

    function validacao(opcao){
        // for(var i = 0 ; i < respostas.length)
        var selecionada = opcao.value;
        console.log("ESTE É A OPÇÃO:"+opcao.value)
        if(selecionada.indexOf("pergunta1Certa") == 0 || selecionada.indexOf("pergunta1Errado") == 0){

            resposta1 = opcao.value;
            console.log("ESSE é o primeiro btn "+alternativa1);
            if(alternativa1 == ""){
                alternativa1 = opcao;
                alternativa1.className = "button-quiz-selecionado";
            }
            else{
                alternativa1.className = "button-quiz";
                alternativa1 = opcao;
                alternativa1.className = "button-quiz-selecionado";
            }
            console.log("ESSE é o segundo btn "+alternativa1);
            console.log("estou na 1 e a resposta é:"+resposta1)
           
            
        }
        else if(selecionada.indexOf("pergunta2Certa") == 0 || selecionada.indexOf("pergunta2Errado") == 0){
            resposta2 = opcao.value;
            if(alternativa2 == ""){
                alternativa2 = opcao;
                alternativa2.className = "button-quiz-selecionado";
            }
            else{
                alternativa2.className = "button-quiz";
                alternativa2 = opcao;
                alternativa2.className = "button-quiz-selecionado";
            }
            console.log("estou na 2 e a resposta é:"+resposta2)

           
        }
        else if(selecionada.indexOf("pergunta3Certa") == 0 || selecionada.indexOf("pergunta3Errado") == 0){
            resposta3 = opcao.value;
            if(alternativa3 == ""){
                alternativa3 = opcao;
                alternativa3.className = "button-quiz-selecionado";
            }
            else{
                alternativa3.className = "button-quiz";
                alternativa3 = opcao;
                alternativa3.className = "button-quiz-selecionado";
            }
            console.log("estou na 3 e a resposta é:"+resposta3)


            
        }
        else if(selecionada.indexOf("pergunta4Certa") == 0 || selecionada.indexOf("pergunta4Errado") == 0){
            resposta4 = opcao.value;
            if(alternativa4 == ""){
                alternativa4 = opcao;
                alternativa4.className = "button-quiz-selecionado";
            }
            else{
                alternativa4.className = "button-quiz";
                alternativa4 = opcao;
                alternativa4.className = "button-quiz-selecionado";
            }
            console.log("estou na 4 e a resposta é:"+resposta4)
  
        }
        else if(selecionada.indexOf("pergunta5Certa") == 0 || selecionada.indexOf("pergunta5Errado") == 0){
            resposta5 = opcao.value;
            console.log("estou na 5 e a resposta é:"+resposta5)
            if(alternativa5 == ""){
                alternativa5 = opcao;
                alternativa5.className = "button-quiz-selecionado";
            }
            else{
                alternativa5.className = "button-quiz";
                alternativa5 = opcao;
                alternativa5.className = "button-quiz-selecionado";
            }
   
        }
        else if(selecionada.indexOf("pergunta6Certa") == 0 || selecionada.indexOf("pergunta6Errado") == 0){
            resposta6 = opcao.value;
            if(alternativa6 == ""){
                alternativa6 = opcao;
                alternativa6.className = "button-quiz-selecionado";
            }
            else{
                alternativa6.className = "button-quiz";
                alternativa6 = opcao;
                alternativa6.className = "button-quiz-selecionado";
            }
            console.log("estou na 6 e a resposta é:"+resposta6)
            
        
        }
        else if(selecionada.indexOf("pergunta7Certa") == 0 || selecionada.indexOf("pergunta7Errado") == 0){
            resposta7 = opcao.value;
            if(alternativa7 == ""){
                alternativa7 = opcao;
                alternativa7.className = "button-quiz-selecionado";
            }
            else{
                alternativa7.className = "button-quiz";
                alternativa7 = opcao;
                alternativa7.className = "button-quiz-selecionado";
            }
            console.log("estou na 7 e a resposta é:"+resposta7)
    
        }
        
        console.log(resposta1,resposta2,resposta3,resposta4,resposta5,resposta6,resposta7);
    }
    function finalizarQuiz(){
        if(resposta1 == undefined){
            alert("Respoda todas as perguntas")
        }
        else{

                respostas.push(resposta1,resposta2,resposta3,resposta4,resposta5,resposta6,resposta7);
                for(var i = 0; i<respostas.length;i++){
                    if(respostas[i].indexOf(`pergunta${i+1}Errado`)==0){
                        erros = erros + 1;
                    }
                    else{
                        acertos = acertos + 1;
                    }
                }
        
            
        
                // Enviando o valor da nova input
                fetch("/quiz/cadastrar", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        // crie um atributo que recebe o valor recuperado aqui
                        // Agora vá para o arquivo routes/usuario.js
                        acertosServer : acertos,
                        errosServer : erros,
                        fkUsuarioServer: sessionStorage.ID_USUARIO
                    })
                }).then(function (resposta) {
        
                    console.log("resposta: ", resposta);
        
                    if (resposta.ok) {
                        // cardErro.style.display = "block";
                        // cardErro.style.zIndex = "999";
                        // mensagem_erro.innerHTML = "Cadastro realizado com sucesso! Redirecionando para tela de Login...";
                        if(acertos < 2){
                            var mensagem = `Goku está chorando agora, você acertou apenas ${acertos}/7`;
                            var src="../img/goku-chorando.gif";
                        }
                        else if(acertos < 4){
                            var mensagem = `Puts, você é horrível acertou apenas ${acertos}/7`;
                            var src = "../img/vegeta-chuva.gif";
                        }
                        else if(acertos < 6){
                            var mensagem = `Tá jóia acertou ${acertos}/7`;
                            var src = "../img/goku-joia.gif";
                        }
                        else{
                            var mensagem = `Parabéns, você é incrível ${acertos}/7`;
                            var src="../img/palmas-goku.gif";
                        }

                        setTimeout(() => {
                            pag7.style.display = "none";
                            pag8.style.display = "block";
                            resultado.innerHTML = mensagem;
                            imgResultado.src = src;
                            btnNavs.style.display = "none";
                        }, "1000")
        
                        // limparFormulario();
                        // finalizarAguardar();
                    } else {
                        throw ("Houve um erro ao tentar realizar o cadastro!");
                    }
                }).catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);
                    // finalizarAguardar();
                });
                
                return false;
                console.log("Erro:"+erros,"Acertos:"+acertos);
            }
        }

    function navegacao(btn){
        var pag = btn.value;
   
        console.log(pag);

        if(pag == 1){
            btn1 = btn;
            pag1.style.display = "block";
            pag2.style.display = "none";
            pag3.style.display = "none";
            pag4.style.display = "none";
            pag5.style.display = "none";
            pag6.style.display = "none";
            pag7.style.display = "none";

            btnNav1.className = "btn-nav-selecionado";
            btnNav2.className = "btn-nav";
            btnNav3.className = "btn-nav";
            btnNav4.className = "btn-nav";
            btnNav5.className = "btn-nav";
            btnNav6.className = "btn-nav";
            btnNav7.className = "btn-nav";
            
        }
        else if(pag == 2){
            btn2 = btn;
            pag1.style.display = "none";
            pag2.style.display = "block";
            pag3.style.display = "none";
            pag4.style.display = "none";
            pag5.style.display = "none";
            pag6.style.display = "none";
            pag7.style.display = "none";
            
            btnNav1.className = "btn-nav";
            btnNav2.className = "btn-nav-selecionado";
            btnNav3.className = "btn-nav";
            btnNav4.className = "btn-nav";
            btnNav5.className = "btn-nav";
            btnNav6.className = "btn-nav";
            btnNav7.className = "btn-nav";
        }
        else if(pag == 3){
            pag1.style.display = "none";
            pag2.style.display = "none";
            pag3.style.display = "block";
            pag4.style.display = "none";
            pag5.style.display = "none";
            pag6.style.display = "none";
            pag7.style.display = "none";

            btnNav1.className = "btn-nav";
            btnNav2.className = "btn-nav";
            btnNav3.className = "btn-nav-selecionado";
            btnNav4.className = "btn-nav";
            btnNav5.className = "btn-nav";
            btnNav6.className = "btn-nav";
            btnNav7.className = "btn-nav";
        }
        else if(pag == 4){
            pag1.style.display = "none";
            pag2.style.display = "none";
            pag3.style.display = "none";
            pag4.style.display = "block";
            pag5.style.display = "none";
            pag6.style.display = "none";
            pag7.style.display = "none";

            btnNav1.className = "btn-nav";
            btnNav2.className = "btn-nav";
            btnNav3.className = "btn-nav";
            btnNav4.className = "btn-nav-selecionado";
            btnNav5.className = "btn-nav";
            btnNav6.className = "btn-nav";
            btnNav7.className = "btn-nav";  
        }
        else if(pag == 5){
            pag1.style.display = "none";
            pag2.style.display = "none";
            pag3.style.display = "none";
            pag4.style.display = "none";
            pag5.style.display = "block";
            pag6.style.display = "none";
            pag7.style.display = "none";

            btnNav1.className = "btn-nav";
            btnNav2.className = "btn-nav";
            btnNav3.className = "btn-nav";
            btnNav4.className = "btn-nav";
            btnNav5.className = "btn-nav-selecionado";
            btnNav6.className = "btn-nav";
            btnNav7.className = "btn-nav";
        }
        else if(pag == 6){
            pag1.style.display = "none";
            pag2.style.display = "none";
            pag3.style.display = "none";
            pag4.style.display = "none";
            pag5.style.display = "none";
            pag6.style.display = "block";
            pag7.style.display = "none";

            btnNav1.className = "btn-nav";
            btnNav2.className = "btn-nav";
            btnNav3.className = "btn-nav";
            btnNav4.className = "btn-nav";
            btnNav5.className = "btn-nav";
            btnNav6.className = "btn-nav-selecionado";
            btnNav7.className = "btn-nav";
        }
        else if(pag == 7){
            pag1.style.display = "none";
            pag2.style.display = "none";
            pag3.style.display = "none";
            pag4.style.display = "none";
            pag5.style.display = "none";
            pag6.style.display = "none";
            pag7.style.display = "block"
            
            btnNav1.className = "btn-nav";
            btnNav2.className = "btn-nav";
            btnNav3.className = "btn-nav";
            btnNav4.className = "btn-nav";
            btnNav5.className = "btn-nav";
            btnNav6.className = "btn-nav";
            btnNav7.className = "btn-nav-selecionado";
        }
    }
</script>